//LCD display driver
#import "6502.util"

//Memory Map
program_addr := 8000;
lcd_addr := 7

main : func () {
    init_stack();

    lcd_addr[0] = BACKGROUND_INSTRUCTION;
    init_lcd();

    run_lcd();
}

set_begin(program_addr, main);

            strncpy(id_name, token.start, token.size);
            Symbol* node = search_symbol_table(id_name, root);

            if (node == NULL) {
                node = enter_symbol(id_name, &root);
                line = alloc_struct(LineHead);
                line->head = line->tail = NULL;
                node->info = (char*) line;
            }

            LineInfo* line_info = alloc_struct(LineInfo);
            line_info->next = NULL;
            line_info->line = token.line;

            LineHead* head;
            head = (LineHead*) node->info;
            if (head->head == NULL)
                head->head = head->tail = line_info;
            else {
                head->tail->next = line_info;
                head->tail = line_info;
            }
        }
    } while(token.code != T_EOF);